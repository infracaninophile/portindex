
FreeBSD-Portindex version 1.6
=============================

$Id: README,v 1.8 2006-06-25 14:44:15 matthew Exp $

   portindex, cache-init, cache-update and find-updated are a set of
   perl scripts built around the common core of the FreeBSD::Portindex
   perl modules. Their use is to generate and maintain the ports INDEX
   or INDEX-5 or INDEX-6 files speedily and efficiently. Ultimately
   they work in a very similar way to the standard make index command,
   except that the FreeBSD::Portindex tools keep a cache of the make
   describe output from each port, and can update that cached data
   incrementally as the ports tree itself is updated.

   Incremental updating is much faster than building the INDEX entirely
   from scratch every time. Once the cache has been initialised, all of
   the changes made over the course of a day or a week can be incorporated
   in a few seconds, and an up to date INDEX file produced in a couple
   more.

   The cache-update process can either take the output of running cvsup
   over the ports-all collection, or it can read cvsup's checkouts file
   (usually /usr/sup/ports-all/checkouts.cvs:.) to work out which ports
   have been modified or deleted recently, and so need their cached
   description updated. Of course, it can also just read a simple list of
   the port origins to re-check, which you can generate using find-updated
   or how you will.

DEPENDENCIES

This module requires these other modules and libraries:

   BerkeleyDB 0.25

   0) Prerequisites: you will need to have installed perl-5.8.5
   (lang/perl5.8) p5-BerkeleyDB-0.25_1 (databases/p5-BerkeleyDB) and
   db42-4.2.52_3 (databases/db42). Later versions will work, earlier
   ones perl or BDB versions may work, but have not been tested.

INSTALLATION

   i) Download and unpack the portsindex tar-ball, and install:

        % tar -jxvf FreeBSD-Portindex-N.NN.tar.bz2
        % cd FreeBSD-Portindex-N.NN
        % perl Makefile.PL
        % make
        % make test
        # make install
        % rehash

   Of course, installing via the sysutils/p5-FreeBSD-Portindex port
   will be the recommended method, as soon as that port gets committed.

QUICK START

  ii) Initialise the Cache

   This is a slow step (slower than make index) but it only needs to be
   done once.

        # mkdir /var/db/portindex
        # chown user:group /var/db/portindex
        % cache-init

   That creates the portsindex cache file (about 10.25MiB currently)
   Nb. while you can run any of the FreeBSD::Portindex programs as
   root safely enough, on general principles I recommend using a
   non-privileged user account instead.

Then, for day to day use:

  iii) Update the Cache

   Before generating a new INDEX file, update the FreeBSD::Portindex cache
   with the details of any recently updated ports. The recommended way to
   do this is by parsing the output of cvsup. See the POD pages for
   cache-update and find-updated for other possibilities.

       # script /tmp/cvsup.out \
            cvsup -g -L2 -h cvsupN.XX.freebsd.org \
            /usr/share/examples/cvsup/ports-supfile
       % cache-update -i /tmp/cvsup.out

   Repeat as necessary if you run cvsup several times between generating
   new INDEX files.

  iv) Generate the INDEX file

       # portindex -o /usr/ports/INDEX

   Steps (iii) and (iv) together should usually take a minute or less:
   very much faster than building the INDEX file from scratch each
   time you update your ports.


BUGS

   Please report any bugs to me, Matthew Seaman
   (m.seaman@infracaninophile.co.uk) with as much detail as
   possible so I can try and reproduce them. Please try and include:

       FreeBSD version -- uname -a output.
       Perl version --' perl -V output.
       Transcript of session showing how the problem occurs.

   As well as anything else you think is relevant.

COPYRIGHT AND LICENCE

Copyright (C) 2004-2006 by Matthew Seaman

This library is free software; you can redistribute it and/or modify
it under the following 2-clause BSD style license:

# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
#
#    1.  Redistributions of source code must retain the above
#        copyright notice, this list of conditions and the following
#        disclaimer.
#
#    2.  Redistributions in binary form must reproduce the above
#        copyright notice, this list of conditions and the following
#        disclaimer in the documentation and/or other materials
#        provided with the distribution.
#
# THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS''
# AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
# TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
# PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR OR
# CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
# SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
# LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF
# USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
# ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
# OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
# OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
# SUCH DAMAGE.

